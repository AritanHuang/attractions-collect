import{a as i,S as d}from"./bootstrap.min-f808e228.js";const r="https://json-auth-test.onrender.com",c=location.href.split("=")[1],b=document.querySelector("#attractions-detail");let m="",a={};const g=document.querySelector("#btn-login-main"),u=document.querySelector("#btn-logout"),f=document.querySelector("#btn-signup-main"),h=document.querySelector("#btn-collect-list"),S=document.querySelector("#btn-backstage");let L=localStorage.getItem("role");i.get(`${r}/views/${c}`).then(function(t){a=t.data,$()}).catch(function(t){console.log(t)});function $(){m=`<h2>${a.name}</h2> <p>${a.description}</p>  <a class="btn btn-primary d-none" id=btn-add-collect-${c} href="">收藏景點</a>`,b.innerHTML=m,p();let t="";t=localStorage.getItem("token");let s=localStorage.getItem("id");const n=document.getElementById(`btn-add-collect-${c}`);t!==null&&(g.classList.add("d-none"),f.classList.add("d-none"),u.classList.remove("d-none"),h.classList.remove("d-none"),n.classList.remove("d-none"),L==="admin"&&S.classList.remove("d-none"),n.addEventListener("click",function(o){if(o.preventDefault(),o.target.textContent==="刪除收藏")o.target.textContent="收藏景點",i.delete(`${r}/600/collects/${c}`,{headers:{Authorization:`Bearer ${t}`}}).then(function(e){d.fire({icon:"success",title:"成功",text:"成功刪除"})}).catch(function(e){console.log(e.message)});else if(o.target.textContent==="收藏景點"){let e={};e.name=a.name,e.description=a.description,e.id=c,e.isCollected="true",o.target.textContent="刪除收藏",i.post(`${r}/600/users/${s}/collects`,e,{headers:{Authorization:`Bearer ${t}`}}).then(function(l){d.fire({icon:"success",title:"成功",text:`成功收藏[${l.data.name}]`})}).catch(function(l){console.log(l.message)})}}))}function p(){let t=localStorage.getItem("token"),s=localStorage.getItem("id");t!==null&&i.get(`${r}/600/users/${s}/collects`,{headers:{Authorization:`Bearer ${t}`}}).then(function(n){const o=n.data,e=document.getElementById(`btn-add-collect-${c}`);o.forEach(function(l){l.id===c&&(l.isCollected?e.textContent="刪除收藏":e.textContent="收藏景點")})}).catch(function(n){console.log(n.message)})}u.addEventListener("click",function(t){const s=document.querySelectorAll("#btn-collect");localStorage.clear(),d.fire({icon:"success",title:"成功",text:"登出成功"}),g.classList.remove("d-none"),f.classList.remove("d-none"),u.classList.add("d-none"),h.classList.add("d-none"),s.forEach(function(n){n.classList.add("d-none")}),location.href="index.html"});
