import{S as i,a as r}from"./bootstrap.min-f808e228.js";const d="https://json-auth-test.onrender.com",$=document.querySelector("#attractions-list");let f=[],g="";function p(){r.get(`${d}/views`).then(function(t){f=t.data,k(),y()}).catch(function(t){console.log(t.message)})}function k(){f.forEach(function(t){g+=`<li class="col-12 col-sm-6 col-lg-4">
        <div class="card h-100">
          <div class="card-header">
            ${t.name}
          </div>
          <div class="card-body">
            <p class="card-text">${t.description}</p>
          </div>
          <div class="card-footer d-flex justify-content-between">
          <a href="attractions-more.html?id=${t.id}" class="btn btn-primary">詳細資料</a>   
          <a id="btn-collect-${t.id}" href="" data-num="${t.id}" class="btn btn-success d-none">收藏景點</a>
          </div>
        </div>
      </li>`}),$.innerHTML=g,x()}p();const h=document.querySelector("#btn-login-main"),m=document.querySelector("#btn-logout"),b=document.querySelector("#btn-signup-main"),S=document.querySelector("#btn-collect-list"),v=document.querySelector("#btn-backstage");let L=localStorage.getItem("role");function x(){const t=document.querySelectorAll(".btn-success");let e=localStorage.getItem("token");e!==null?(t.forEach(function(n){n.classList.remove("d-none"),n.addEventListener("click",function(o){o.preventDefault();let c=o.target.getAttribute("data-num"),u=localStorage.getItem("id"),s=f[c-1],a={};a.name=s.name,a.description=s.description,a.id=c,o.target.textContent==="收藏景點"?(a.isCollected="true",o.target.textContent="刪除收藏",r.post(`${d}/600/users/${u}/collects`,a,{headers:{Authorization:`Bearer ${e}`}}).then(function(l){i.fire({icon:"success",title:"成功",text:`成功收藏[${l.data.name}]`})}).catch(function(l){console.log(l.message)})):(o.target.textContent="收藏景點",r.delete(`${d}/600/collects/${c}`,{headers:{Authorization:`Bearer ${e}`}}).then(function(l){i.fire({icon:"success",title:"成功",text:"成功刪除"})}).catch(function(l){console.log(l.message)}))})}),m.classList.remove("d-none"),S.classList.remove("d-none"),h.classList.add("d-none"),b.classList.add("d-none"),L==="admin"&&v.classList.remove("d-none")):e===null&&i.fire({icon:"info",title:"提醒",text:"記得登入才能收藏景點喔！",footer:'<a href="login.html">登入</a>'})}function y(){let t=localStorage.getItem("token"),e=localStorage.getItem("id");t!==null&&r.get(`${d}/600/users/${e}/collects`,{headers:{Authorization:`Bearer ${t}`}}).then(function(n){n.data.forEach(function(c){const u=c.id,s=document.querySelector(`#btn-collect-${u}`);c.isCollected?s.textContent="刪除收藏":s.textContent="收藏景點"})}).catch(function(n){console.log(n.message)})}window.location.pathname.includes("/admin.html")&&I();function I(){const t=localStorage.getItem("token"),e=localStorage.getItem("role");console.log(t,e),(t===null||e!=="admin")&&alert("您沒有拜訪後台的權限！")}m.addEventListener("click",function(t){const e=document.querySelectorAll(".btn-success");localStorage.clear(),i.fire({icon:"success",title:"成功",text:"登出成功"}),h.classList.remove("d-none"),b.classList.remove("d-none"),m.classList.add("d-none"),S.classList.add("d-none"),L==="admin"&&v.classList.add("d-none"),e.forEach(function(n){n.classList.add("d-none")})});
